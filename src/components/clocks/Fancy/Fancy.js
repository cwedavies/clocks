import classnames from "classnames";
import _ from "lodash/fp";
import React, { useRef } from "react";
import { useDebug } from "../../../hooks/debug";
import Mark from "../../Mark";

const positions = [
  { x: 4, y: -88 },
  { x: 92, y: -6 },
  { x: 2, y: 82 },
  { x: -92, y: 0 },
];

const Fancy = (props) => {
  const { x, y, scale, onClick, text, marks = 0 } = props;
  const { debug } = useDebug();
  const id = useRef(_.uniqueId());

  const arcp = 200 * 0.75;

  const className = classnames({ debug });

  const markPositions = _.take(marks, positions);

  return (
    <g className={className} transform={`translate(${x},${y}) scale(${scale})`}>
      <defs>
        <path
          id={id.current}
          d={`M ${-arcp} 20 A ${arcp} ${arcp * 1.2} 0 0 1 ${arcp} 20`}
        />
      </defs>
      <circle onClick={onClick} className="bounds" r={200} />
      <g transform="scale(2) translate(-100, -100)">
        <path
          r={200 * 0.7}
          d="M71.975,39.149c0.324,-0.134 1.97,-1.619 2.35,-2.155c0.919,-1.295 1.952,-2.511 3.094,-3.626c3.859,-3.768 8.807,-6.359 14.077,-7.482c1.973,-0.421 4.811,-0.963 6.835,-0.957c2.034,0.019 3.23,0.607 5.193,1.08c7.213,1.741 13.709,6.373 17.796,12.597c7.574,4.163 11.617,6.652 17.344,11.552c7.872,6.733 16.078,15.295 20.262,25.059c0.124,0.289 0.244,0.578 0.36,0.868c0.115,0.286 0.822,1.242 1.101,1.434c6.072,4.188 9.067,10.731 10.481,18.1c1.001,5.219 0.864,10.512 -1.091,15.442c-2.043,5.149 -4.208,9.655 -8.503,12.927c-0.419,0.32 -1.538,1.717 -1.712,2.138c-2.913,7.054 -7.361,14.033 -12.463,19.694c-6.5,7.21 -14.784,12.734 -23.917,16.582c-0.352,0.148 -0.705,0.294 -1.06,0.436c-0.298,0.119 -1.497,1.19 -1.808,1.633c-2.991,4.265 -7.072,7.749 -11.894,9.79c-5.182,2.193 -10.955,2.563 -16.446,1.415c-1.037,-0.216 -0.849,-1.244 -1.864,-1.549c-0.771,-0.232 -2.995,0.021 -3.75,-0.263c-5.128,-1.93 -8.707,-4.736 -12.019,-9.099c-0.412,-0.543 -2.388,-2.16 -2.989,-2.415c-13.085,-5.549 -25.448,-17.561 -32.747,-29.915c-1.322,-2.236 -1.992,-2.722 -3.049,-5.119c-0.301,-0.681 -1.889,-3.419 -2.216,-3.637c-3.995,-2.663 -6.603,-5.912 -8.746,-10.289c-2.757,-5.629 -4.209,-12.157 -2.941,-18.291c1.136,-5.497 4.618,-10.678 8.647,-14.612c1.145,-1.118 2.388,-2.133 3.707,-3.037c0.379,-0.26 1.392,-1.44 1.531,-1.78c0.144,-0.352 0.291,-0.702 0.441,-1.051c4.3,-10.009 12.431,-19.532 20.905,-26.374c4.959,-4.003 9.173,-6.657 15.091,-9.096Zm31.393,85.157c-8.005,-1.848 -16.967,0.68 -23.067,6.329c-3.026,2.921 -5.339,6.569 -6.53,10.621c-0.523,1.86 -0.82,3.781 -0.893,5.714c-0.255,9.833 5.788,19.743 14.917,23.607c0.967,0.409 1.711,1.973 2.718,2.237c0.889,0.233 2.036,-0.818 2.944,-0.694c10.009,1.365 20.913,-3.773 25.666,-12.921c1.397,-2.744 0.993,-5.6 1.207,-8.638c0.149,-2.491 1.08,-5.145 0.476,-7.596c-2.104,-8.539 -8.517,-16.209 -17.438,-18.659Zm-34.325,-68.064c-0.351,-3.572 -0.045,-7.221 1,-10.732c0.132,-0.443 -0.386,-0.927 -0.647,-0.796c-5.337,2.685 -11.079,5.628 -15.437,9.663c-5.526,5.116 -9.323,11.687 -12.722,18.423c-0.205,0.406 0.125,0.977 0.491,0.865c0.839,-0.256 1.687,-0.467 2.54,-0.635c2.008,-0.437 4.064,-0.661 6.125,-0.654c4.742,0.045 9.382,1.4 13.486,3.728c2.421,1.373 5.393,2.675 7.353,4.656c2.953,2.893 4.546,6.824 5.925,10.816c0.258,0.746 0.483,1.503 0.674,2.267c0.141,0.543 0.266,1.091 0.372,1.645c0.293,1.53 0.444,3.077 0.461,4.625c0.131,6.229 -2.314,12.508 -5.988,17.543c-1.668,2.286 -4.263,3.871 -6.532,5.534c-1.828,1.429 -2.688,3.04 -4.843,3.952c-2.519,1.066 -5.177,1.701 -7.874,1.94c-3.877,0.48 -7.862,0.189 -11.679,-0.981c-0.373,-0.114 -0.797,0.287 -0.635,0.612c5.984,11.987 15.887,22.023 27.949,28.163c0.467,0.238 1.049,-0.384 0.896,-0.931c-0.486,-1.736 -0.783,-3.514 -0.903,-5.304c-0.664,-8.393 2.31,-17.124 8.364,-23.035c1.952,-1.906 8.89,-5.933 10.111,-6.38c1.807,-0.662 3.679,-1.127 5.579,-1.399c1.455,-0.224 2.927,-0.337 4.403,-0.332c0.814,0.008 1.843,-0.146 5.158,0.802c3.44,0.984 9.185,3.091 10.875,4.263c3.308,2.294 4.856,4.126 6.888,7.561c1.781,2.827 3.2,7.542 3.84,10.88c0.419,2.184 2.057,6.975 0.664,12.045c-0.217,0.792 -2.039,3.235 1.144,1.58c11.409,-5.934 20.889,-15.376 26.872,-26.762c1.568,-2.985 -0.683,-1.563 -1.575,-1.353c-3.616,0.853 -7.384,0.91 -11.053,0.277c-8.996,-1.496 -17.416,-7.07 -21.493,-15.398c-0.224,-0.457 -0.434,-0.921 -0.63,-1.39c-0.188,-0.434 -0.364,-0.876 -0.528,-1.323c-1.45,-3.957 -2.87,-8.494 -2.476,-12.684c0.457,-4.849 3.031,-9.324 5.81,-13.331c0.537,-0.774 1.112,-1.515 1.724,-2.224c0.531,-0.635 1.093,-1.246 1.684,-1.831c5.312,-5.248 12.787,-8.255 20.215,-8.231c1.354,0.013 2.701,0.132 4.028,0.351c0.988,0.136 1.982,0.29 2.948,0.571c2.547,0.741 1.659,-0.825 1.264,-1.593c-3.128,-6.081 -7.013,-11.793 -11.974,-16.514c-4.794,-4.563 -10.697,-8.132 -16.716,-11.004c0.209,0.586 0.395,1.178 0.558,1.774c0.232,0.79 0.427,1.593 0.583,2.408c2.435,12.693 -4.961,26.599 -16.902,31.654c-0.28,0.118 -0.561,0.231 -0.845,0.339c-0.311,0.122 -0.626,0.237 -0.943,0.347c-8.653,2.991 -18.701,1.476 -26.08,-3.907c-2.135,-1.557 -4.015,-3.423 -5.608,-5.51c-3.005,-3.671 -1.691,-4.278 -2.576,-6.086c-1.538,-3.14 -2.865,-2.704 -3.325,-8.964Zm81.652,21.003c-4.892,-1.212 -10.164,-0.891 -14.9,0.836c-5.257,2.097 -9.816,5.986 -12.668,10.885c-2.384,4.426 -3.417,6.016 -2.932,11.034c1.182,12.244 3.503,14.709 7.62,18.708c4.645,4.136 10.896,6.503 17.201,6.481c8.848,-0.427 17.591,-5.546 21.519,-13.691c6.164,-12.786 -1.593,-30.193 -15.84,-34.253Zm-92.922,0.42c-4.04,-1.285 -8.415,-1.555 -12.628,-0.705c-9.213,2.109 -17.102,9.702 -18.973,19.132c-2.082,10.499 3.699,22.034 13.278,26.802c7.405,3.558 15.6,2.253 22.663,-1.923c3.808,-2.281 7.926,-5.035 9.968,-9.039c0.485,-0.961 0.897,-1.954 1.239,-2.97c2.454,-7.434 1.531,-16.279 -3.111,-22.742c-2.868,-3.991 -7.661,-6.871 -12.436,-8.555Zm61.859,-13.752c2.74,-6.075 2.706,-13.091 0.372,-19.198c-0.464,-1.215 -1.255,-1.556 -2.234,-3.276c-0.461,-0.809 -0.394,-1.839 -0.943,-2.591c-2.862,-3.919 -6.906,-6.986 -11.936,-8.441c-1.869,-0.541 -5.002,-1.1 -7.088,-1.146c-0.211,-0.004 -0.423,-0.005 -0.634,-0.004c-1.604,0.015 -3.193,0.203 -4.745,0.548c-7.867,1.744 -14.78,7.488 -17.854,14.944c-1.338,3.579 -1.702,7.454 -1.222,11.256c0.718,5.695 -0.136,5.762 0.89,8.116c0.916,2.102 0.921,0.412 4.666,5.153c2.806,3.551 6.542,6.36 10.994,7.829c8.14,2.492 18.251,1.007 24.674,-4.626c2.425,-2.16 3.693,-5.598 5.06,-8.564Z"
        />
      </g>

      <text textAnchor="middle">
        <textPath href={`#${id.current}`} startOffset="50%">
          {text}
        </textPath>
      </text>
      {_.map(
        (position) => (
          <Mark {...position} />
        ),
        markPositions
      )}
    </g>
  );
};

Fancy.size = 200;

export default Fancy;
